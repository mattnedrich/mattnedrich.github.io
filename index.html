<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Matt Nedrich</title>
  <meta name="author" content="Matt Nedrich">

  
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.mattnedrich.com">
  <link href="/favicon.png" type="image/png" rel="icon">
  <link href="/atom.xml" rel="alternate" title="Matt Nedrich" type="application/atom+xml">

  <link href="/assets/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="/assets/bootstrap/dist/css/bootstrap-theme.min.css" rel="stylesheet" type="text/css">
<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
<!-- MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  <script src="/javascripts/libs/jquery/jquery-2.0.3.min.js"></script>
  

</head>

  <body   >
    <div id="wrap">
      <header role="banner">
        <nav class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Matt Nedrich</a>
        </div>

        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="active">
                    <a href="/">Blog</a>
                </li>
                <li >
                    <a href="/blog/archives">Archives</a>
                </li>
				<li >
                    <a href="/projects.html">Projects</a>
                </li>
				<li >
                    <a href="/about.html">About</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a class="subscribe-rss" href="/atom.xml" title="subscribe via RSS">
                        <span class="visible-xs">RSS</span>
                        <img class="hidden-xs" src="/images/rss.png" alt="RSS">
                    </a>
                </li>
                
            </ul>
            
                <form class="search navbar-form navbar-right" action="http://google.com/search" method="GET">
                    <input type="hidden" name="q" value="site:www.mattnedrich.com">
                    <div class="form-group">
                        <input class="form-control" type="text" name="q" placeholder="Search">
                    </div>
                </form>
            
        </div>
    </div>
</nav>


      </header>
      <div id="main" class="container">
        <div id="content">
          <div class="row">
  <div class="page-content col-md-9">
    <div class="blog-index">
      
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-02-17T13:36:31-05:00" pubdate data-updated="true">Feb 17<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/02/17/quicksort-in-c-number/">Quicksort in C#</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I have written an implementation of quicksort in C#. It can be found here.<br />
<a href="https://github.com/mattnedrich/algorithms/blob/master/csharp/sorting/quicksort/Quicksorter.cs">https://github.com/mattnedrich/algorithms/blob/master/csharp/sorting/quicksort/Quicksorter.cs</a></p>

<p>It operates on anything that implements <code>IComparable&lt;T&gt;</code>. Suppose you have a class <code>SortableObject</code> that implements <code>IComparable&lt;SortableObject&gt;</code>. The usage model in this scenario would be</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="predefined-type">List</span>&lt;SortableObject&gt; items = ...
Quicksorter&lt;SortableObject&gt; sorter = <span class="keyword">new</span> Quicksorter&lt;SortableObject&gt;();
sorter.Sort(items);
</pre></div>
</div>
 </figure></notextile></div>

<p>My implementation contains a main <code>Partition</code> method that is called recursively to perform the sorting. In addition, there are two helper methods. The first, <code>ChoosePivotIndex</code> is responsible for choosing a pivot element from a list to be sorted. The current implementation naively selects a pivot at random. This method is virtual to keep it <a href="http://en.wikipedia.org/wiki/Open/closed_principle">Open/Closed</a> and allow others to extend it with a better pivot selection method if desired. The other method, <code>Swap</code>, swaps two elements in a list. I’ve found that in-lining the swapping yields faster performance, though I decided not to do so for clarity.</p>

<p>I benchmarked my implementation on different types of input of varying length. Results below.</p>

<p><img width="425px" src="/images/quicksort_csharp/quicksort_perf.png" /></p>

<p>As displayed, my implementation (even with the naive pivot selection) is fairly robust to random, sorted, and reverse sorted lists.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-02-16T16:22:30-05:00" pubdate data-updated="true">Feb 16<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/02/16/c-sharp-sorting-woes/">C# Sorting Woes</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I was having some fun implementing sorting algorithms and thought it might be interesting to compare my implementations against the C# built in <code>List&lt;T&gt;.Sort</code>. That was where the rabbit hole started. </p>

<h3 id="slow-quicksort">Slow Quicksort</h3>
<p>After finishing an implementation of quicksort I decided to give it a try on some big input. I wrote something to generate integer lists of arbitrary size with uniformly random elements. I ran some benchmarks, and then ran the same input against <code>List&lt;T&gt;.Sort</code>. My implementation was about <b>ten times</b> slower than the built in sort. I thought I must be doing something wrong. There must be some bug in my code. After all, the description of <code>List&lt;T&gt;.Sort</code> states that (from <a href="http://msdn.microsoft.com/en-us/library/b0zbh7b6%28v=vs.110%29.aspx">here</a>)</p>

<ul>
  <li>If the partition size is fewer than 16 elements, it uses an insertion sort algorithm.</li>
  <li>If the number of partitions exceeds 2 * LogN, where N is the range of the input array, it uses a Heapsort algorithm.</li>
  <li>Otherwise, it uses a Quicksort algorithm.</li>
</ul>

<p>So the built-in sorting should be using Quicksort <em>most</em> of the time. I thought my implementation might just be slow, so I started to make some optimizations. My base implementation can be found here:<br />
<a href="https://github.com/mattnedrich/algorithms/blob/master/csharp/sorting/quicksort/Quicksorter.cs">https://github.com/mattnedrich/algorithms/blob/master/csharp/sorting/quicksort/Quicksorter.cs</a></p>

<p>First I tried to in-line all of the function calls (e.g., <code>ChoosePivotIndex</code> and <code>Swap</code>). This yielded some performance improvement (about 10%). Next I played around with the pivot selection method. I was using a naive random pivot selection so I tried a median of three approach. This actually didn’t do much, though I suspect it is because my input was uniformly random. I tried parallelizing the calls to <code>Partition</code>. This actually slowed things down (probably due to the overhead of thread creation). Lastly, I cheated a bit and switched to insertion sort for small inputs, as the library sort does. This yielded the latest performance gain of around 20%. However, after all of my optimization, I was still around eight times slower than <code>List&lt;T&gt;.Sort</code>.</p>

<p>I was stuck, so I posted <a href="http://stackoverflow.com/questions/21818889/why-is-my-c-sharp-quicksort-implementation-significantly-slower-than-listt-sor">this</a>, and learned that the .NET Framework special cases the sorting of built-in types (ints, string, etc). Just how much of a performance gain is achieved by doing this? I wanted to find out so I set up yet another experiment.</p>

<h3 id="int-vs-intinwrapper">Int vs. IntInWrapper</h3>
<p>I compared the performance of <code>List&lt;T&gt;.Sort</code> when using plain ol’ <code>int</code>’s to the performance when using <code>int</code>’s in a wrapper class. For the wrapper class I used:</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="directive">public</span> <span class="type">class</span> <span class="class">IntInWrapper</span> : IComparable&lt;IntInWrapper&gt;
{
    <span class="directive">public</span> <span class="type">int</span> Val { get; set; }
    <span class="directive">public</span> IntInWrapper(<span class="type">int</span> val)
    {
        Val = val;
    }

    <span class="directive">public</span> <span class="type">int</span> CompareTo(IntInWrapper other)
    {
        <span class="keyword">if</span> (<span class="local-variable">this</span>.Val &lt; other.Val)
            <span class="keyword">return</span> -<span class="integer">1</span>;
        <span class="keyword">else</span> <span class="keyword">if</span> (<span class="local-variable">this</span>.Val == other.Val)
            <span class="keyword">return</span> <span class="integer">0</span>;
        <span class="keyword">else</span>
            <span class="keyword">return</span> <span class="integer">1</span>;
    }
}
</pre></div>
</div>
 </figure></notextile></div>

<p>I benchmarked sorting Lists of various sizes for the two input classes. Results are shown below. For each List size, sorting was performed ten times (each time on a different randomized list), and the average execution time was kept.</p>

<p><img width="450px" src="/images/c_sharp_sorting/ListT.png" /></p>

<p>Sorting on wrapped <code>int</code>’s drastically degrades performance compared to plain  <code>int</code>’s. From my understanding, this is largely due to the <code>IComparable&lt;T&gt;.CompareTo</code> function pointer being used for element comparison, rather than a simple <code>&gt;</code> or <code>&lt;</code> (which likely trickles down to a single assembly instruction). Anyway, the key learning from this is that use built-in types when you need sorting performance and be aware of the penalty associated with using custom types! </p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-02-14T11:26:01-05:00" pubdate data-updated="true">Feb 14<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/02/14/fun-onenote-problem/">Hide and Seek With OneNote</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I often open command windows on Windows via <code>shift + right click</code> on a directory. It’s a handy way to open a cmd window right where you want one. Ironically the option directly below <code>Open command window here</code> is <code>Open as Notebook in OneNote</code>. I accidentally clicked the OneNote option and it turned out to be a pretty interesting 10 pixel mistake.</p>

<p><img width="250px" src="/images/onenote_fun/onenote_cmd_window.jpg" /></p>

<p>Some backstory - my original intent was to open a cmd window to the source directory of my blog to build it (I’m using Octopress). At first it wasn’t clear what clicking the OneNote option actually did. However, after a little poking around I was seeing a <code>OneNote Table Of Content.onetoc2</code> file in every directory of my blog output. That is, I didn’t see these in the blog source directory, but every time I would build my blog they would show up in <strong>every</strong> output directory.</p>

<p>I tried grepping for interesting files/directories in the blog source, but nothing showed up. I tried manually browsing through the source directory structure. Also note that I had show hidden files and folders turned on. Still, I found nothing.</p>

<p>After some digging, and a lot of help from this <a href="http://www.tigraine.at/2009/09/01/howto-get-rid-of-onetoc2-files-using-powershell">post</a> it turns out that there were several OneNote files embedded and hidden in every directory of my blog source. The only way I was able to see them was to display them in a cmd window via</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
dir /A:H /B
</pre></div>
</div>
 </figure></notextile></div>

<p>After it was clear that they were indeed there but hidden, I was able to delete them via</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
del /S /A:H *.onetoc2
</pre></div>
</div>
 </figure></notextile></div>

</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-02-09T14:45:25-05:00" pubdate data-updated="true">Feb 9<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/02/09/k-means-implementation-in-python/">K-Means in Python</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I’ve written a general K-Means implementation in Python. It can be found here:<br />
<a href="https://github.com/mattnedrich/algorithms/blob/master/python/clustering/kmeans/kmeans.py">https://github.com/mattnedrich/algorithms/blob/master/python/clustering/kmeans/kmeans.py</a></p>

<p>Everything is contained in one file, <code>kmeans.py</code> The usage model is the following</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="keyword">import</span> <span class="include">kmeans</span>

<span class="comment"># observations</span>
<span class="comment">#  - list of items to be clustered</span>
<span class="comment"># numMeans</span>
<span class="comment">#  - number of clusters desired</span>
<span class="comment"># featureVectorFunc</span>
<span class="comment">#  - function that extracts a feature vector (in the form of a Tuple) from an observation</span>
<span class="comment"># maxIterations</span>
<span class="comment">#  - optional param, can be used to set a max number of iterations</span>
[clusters, error, numIter] = kmeans.cluster(observations, numMeans, featureVectorFunc, maxIterations)
</pre></div>
</div>
 </figure></notextile></div>

<p>My goal was to make something simple and accessible that doesn’t require additional libraries (e.g., numpy is not required). The user must do one thing - provide a <code><span class="CodeRay">featureVectorFunc</span></code> that takes in an observation from the input, and returns a feature vector in the form of a Tuple. This function would look something like this:</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="keyword">def</span> <span class="function">someFeatureVectorFunc</span>(obs):
    featureVectorAsTuple = extractFeatureVector(obs)
    <span class="keyword">return</span> featureVectorAsTuple
</pre></div>
</div>
 </figure></notextile></div>

<p>The output clusters is a list of cluster objects. Each cluster has a field called <code><span class="CodeRay">observations</span></code>. This is subset of the original input observations (stored in a list).</p>

<div class="note">
<b>This implementation is not designed for speed</b>. Rather, it&#8217;s designed for flexibility. The user can specify a list containing any type of objects. The required featureVectorFunc is used by the K-Means implementation to extract feature vectors from the input observations.
</div>

<h2 id="example-results">Example Results</h2>
<p>I ran my implementation on the three synthetic datasets below. For each dataset, I used K=5. I also ran K-Means 10 times and selected the result with the lowest error.</p>

<h3 id="dataset-1">Dataset 1</h3>

<p><img width="350px" src="/images/kmeans_python/basicDataPoints.png" />
<img width="350px" src="/images/kmeans_python/basicDataResult.png" /></p>

<h3 id="dataset-2">Dataset 2</h3>

<p><img width="350px" src="/images/kmeans_python/roundDataSetPoints.png" />
<img width="350px" src="/images/kmeans_python/roundDataSetResult.png" /></p>

<h3 id="dataset-3">Dataset 3</h3>

<p><img width="350px" src="/images/kmeans_python/gaussianWithRoundPoints.png" />
<img width="350px" src="/images/kmeans_python/gaussianWithRoundResult.png" /></p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-02-07T00:01:49-05:00" pubdate data-updated="true">Feb 7<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/02/07/benchmarking-c-number/">Benchmarking C# Code</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I occasionally need to benchmark some code. In C#, this can easily be done using the Stopwatch class. After writing the same boilerplate Stopwatch wrapper enough times I decided to throw together a simple Benchmarker class.</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="directive">public</span> <span class="directive">static</span> <span class="type">class</span> <span class="class">Benchmarker</span>
{
    <span class="directive">public</span> <span class="directive">static</span> TimeSpan RunOnce(<span class="predefined-type">Action</span> action)
    {
        Stopwatch stopwatch = Stopwatch.StartNew();
        action();
        stopwatch.Stop();
        <span class="keyword">return</span> stopwatch.Elapsed;
    }
    
    <span class="directive">public</span> <span class="directive">static</span> IEnumerable&lt;TimeSpan&gt; RunMany(<span class="predefined-type">Action</span> action, <span class="type">int</span> runCount)
    {
        <span class="predefined-type">List</span>&lt;TimeSpan&gt; results = <span class="keyword">new</span> <span class="predefined-type">List</span>&lt;TimeSpan&gt;();
        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="integer">0</span>; i &lt; runCount; i++)
            results.Add(RunOnce(action));
        <span class="keyword">return</span> results;
    }
}
</pre></div>
</div>
 </figure></notextile></div>

<p>This allows any code to be easily called and timed. For example, suppose you have a void Method called <code>Foo</code>. This can be timed via:</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
TimeSpan timespan = Benchmarker.RunOnce(() =&gt; Foo());
</pre></div>
</div>
 </figure></notextile></div>

<p>Similarly, if you want to benchmark a method that happens to return something like this</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="type">int</span> bar = FooWithReturnValue();
</pre></div>
</div>
 </figure></notextile></div>

<p>you can use the above Benchmarker class via</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="type">int</span> bar;
TimeSpan timespan = Benchmarker.RunOnce(() =&gt; bar = FooWithReturnValue());
</pre></div>
</div>
 </figure></notextile></div>

<p>I’ve put this on github:
<a href="https://github.com/mattnedrich/tools/tree/master/csharp/Benchmarker.cs">https://github.com/mattnedrich/tools/tree/master/csharp/Benchmarker.cs</a></p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-02-01T14:15:29-05:00" pubdate data-updated="true">Feb 1<span>st</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/02/01/android-virtual-machine-acceleration/">Android Virtual Machine Acceleration</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I’ve dabbled in Android development in the past, but haven’t done much with emulation. In my experience the Android emulators are too slow to use, and I’ve usually used my phone for testing/debugging.</p>

<p>Intel’s <a href="http://software.intel.com/en-us/android/articles/intel-hardware-accelerated-execution-manager">Hardware Accelerated Execution Manager</a> (HAXM) uses CPU virtualization to speed up Android emulators. I wanted to give it a try. </p>

<h2 id="cpu-compatibility">CPU Compatibility</h2>
<p>I have a pretty old desktop machine, so I wasn’t even sure if my CPU supported hardware virtualization. Poking around a bit, there are a few Windows utilities that can be used to determine if virtualizaiton is enabled on your CPU.</p>

<ul>
  <li><a href="http://www.intel.com/support/processors/sb/cs-030729.htm">http://www.intel.com/support/processors/sb/cs-030729.htm</a></li>
  <li><a href="http://www.microsoft.com/en-us/download/details.aspx?id=592">http://www.microsoft.com/en-us/download/details.aspx?id=592</a></li>
  <li><a href="https://www.grc.com/securable.htm">https://www.grc.com/securable.htm</a></li>
</ul>

<p>The Intel utility looks like this:</p>

<p><img width="525px" height="384px" src="/images/android_virtual/vmx_enabled.jpg" /></p>

<h2 id="results">Results</h2>
<p>With virtualization verified and enabled, I followed <a href="http://developer.android.com/tools/devices/emulator.html#acceleration">this</a> writeup to install everything and setup an x86 Android emulator.</p>

<p>So how did it work? It wasn’t that much faster, but there was a noticeable difference. The HAXM emulator booted in 182 seconds, compared to 282 seconds for the ARM emulator. With both emulators open, I could click on a button (e.g., open the Settings app) and the HAXM emulator would finish first, usually by 1-5 seconds depending on the task. As a disclaimer, I was using a pretty old computer. I’m not sure what impact that had on my experience.</p>

<p>Regardless, while there was some speedup, it’s nowhere close to testing/debugging on a real phone (as is to be expected). The emulator is nice for testing different phones/configurations, but in general I find it much nicer to just push my application to a real phone.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-01-26T18:19:21-05:00" pubdate data-updated="true">Jan 26<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/01/26/k-means-basics/">K-Means Clustering</a></h1>
    
  </header>


  <div class="entry-content clearfix"><h2 id="what-is-k-means">What is K-Means</h2>
<p>Need to cluster some data? K-Means is one of the most common and simplistic clustering algorithms. It works by partitioning a data set into K  different groups (clusters). In this post, we’ll walk through the basics of K-Means, explain how it works, and touch on some of its strengths and weaknesses.</p>

<h2 id="the-input">The Input</h2>
<p>The input to K-Means is a set of data and a parameter K, which defines the number of clusters to partition the data into. Each input observation is a vector in d-dimensional space. The number of dimensions doesn’t matter.</p>

<h2 id="the-algorithm">The Algorithm</h2>
<p>The goal of the K-Means algorithm is to find a partitioning of the input data that minimizes within-cluster sum of squares (WCSS). Simply put, the goal is to find a clustering such that the points in each cluster are close together. This objective function (we’ll call it $J$) can be expressed as:</p>

<script type="math/tex; mode=display">
\begin{align}
J=\sum_{k=1}^K\sum_{i=1}^N\lVert\mu_k-x_i\rVert ^2
\end{align}
</script>

<p>Here, $K$ is the number of clusters, $N$ is the number of points, $\mu_k$ is the cluster centroid for cluster $k$, and $x_i$ corresponds to input observation $i$. Informally, this function computes the variance of the observations around each cluster centroid (for a given set of K centroids). The goal is the minimize this function. Each iteration of the K-Means algorithm reduces the objective function, moving closer to a minimum.</p>

<p>K-Means uses an <a href="http://en.wikipedia.org/wiki/Expectation%E2%80%93maximization_algorithm">Expectation Maximization</a> approach to partition the input data and minimize the WCSS. Conceptually, we start with an initial set of cluster centroids (with an implicitly defined WCSS score). The goal is to figure out how to move these centroids around to make the WCSS score as small as possible. The algorithm can be expressed as</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
<span class="float">1.</span> Initialize cluster centroids
<span class="keyword">while</span> <span class="keyword">not</span> converged:
    <span class="float">2.</span> Cluster Assignment - assign each observation to the nearest cluster centroid
    <span class="float">3.</span> Update Centroids - update the cluster centroid locations
</pre></div>
</div>
 </figure></notextile></div>

<p>Let’s go over each of these steps.</p>

<h4 id="initialize-cluter-centroids"><strong>1. Initialize Cluter Centroids</strong></h4>
<p>The first step is to choose an initial set of K cluster centroid locations. This can be done many ways. One approach is to choose K random locations in whatever dimensional space you’re working in. This approach may work, but in practice it may be difficult to choose these locations well. For example, it’s undesirable to choose locations very far away from any of the data. Another, perhaps better, approach is to choose K random observations from the input dataset.</p>

<h4 id="cluster-assignment"><strong>2. Cluster Assignment</strong></h4>
<p>In the cluster assignment step each observation in the dataset is assigned to a cluster centroid. This is done by assigning each observation to it’s nearest centroid.</p>

<div class="note">
<b>Note:</b> The true objective of this step is to minimize the WCSS objective. It just so happens that assinging each observation to the its nearest cluster achieves this when working in Euclidean space. This may not be the case if other distance metrics are used. 
</div>

<h4 id="cluster-centroid-update"><strong>3. Cluster Centroid Update</strong></h4>
<p>Next, in the cluster centroid update step, each cluster centroid is updated to be the center (e.g., mean) of the observations assigned to it.</p>

<p>Steps <strong>2</strong> and <strong>3</strong> are repeated until the algorithm converges. There are a few commonly used ways to determine convergence.</p>

<ol>
  <li><strong>Fixed Iteration Number</strong> - K-Means can be terminated after running for a fixed number of iterations. Obviously, this approach does not guarantee that the algorithm has converged, but can be useful when an approximate solution is sufficient, or termination is difficult to detect.</li>
  <li><strong>No Cluster Assignment Changes</strong> - This is the most common approach. If no observations change cluster membership between iterations, this indicates that the algorithm will not continue further, and can be terminated.</li>
  <li><strong>Error Threshold</strong> - An error threshold can also be used to terminate the algorithm. However, choosing a good threshold is problem and domain specific (e.g., a threshold that works well for one application may not work well for another).</li>
</ol>

<h2 id="example">Example</h2>
<p>K-Means is often best understood visually, so let’s walk through an example. Suppose you have the following data in two dimensional space.</p>

<p><img width="400px" height="300px" src="/images/kmeans_basics/0ab.png" /></p>

<p>The first step is to choose K starting cluster centers. For our example we will set K=5. For our example we’ll randomly select five observations from our data set to be the initial cluster centroids:</p>

<p><img width="400px" height="300px" src="/images/kmeans_basics/0abc.png" /></p>

<p>With the initial cluster centroids selected, steps <strong>2</strong> and <strong>3</strong> are iterated as described above.</p>

<p><img width="270px" src="/images/kmeans_basics/00001_a.png" />
<img width="270px" src="/images/kmeans_basics/00001_b.png" />
<img width="270px" src="/images/kmeans_basics/00001_c.png" /></p>

<p><img width="270px" src="/images/kmeans_basics/00002_a.png" />
<img width="270px" src="/images/kmeans_basics/00002_b.png" />
<img width="270px" src="/images/kmeans_basics/00002_c.png" /></p>

<p><img width="270px" src="/images/kmeans_basics/00003_a.png" />
<img width="270px" src="/images/kmeans_basics/00003_b.png" />
<img width="270px" src="/images/kmeans_basics/00003_c.png" /></p>

<h2 id="other-comments">Other Comments</h2>

<h3 id="repeated-runs">Repeated Runs</h3>
<p>It’s very important to note that K-Means is notorious for getting stuck in local minima. This means that there is no guarantee that running K-Means will actually find the optimal solution for a given starting point (set of initial cluster centroids). To overcome this, K-Means is often run multiple times with different initial cluster centroids, and the clustering with the lowest error (WCSS) is chosen.</p>

<h3 id="choosing-k">Choosing K</h3>
<p>This <a href="http://www.youtube.com/watch?v=Lz0sXs12uPk">video</a> from Andrew Ng’s Machine Learning course on <a href="http://www.coursera.org">Coursera</a> does a great job summarizing the task of choosing K. In general, there is no great general purpose method. Choosing K often requires manual input based on data visualizaiton or other domain knowledge. Interestingly, for some applications, K may already be known. The T-Shirt sizing example in the video is a great example of this. For these types of problems the goal is to partition the data into a pre-defined number of sets, rather than learning how many distinct sub-sets make up the original input data.</p>

<h3 id="strengths-and-weaknesses">Strengths and Weaknesses</h3>
<p><strong>Strengths:</strong> K-Means is great because it’s simple and fast. There are several off the shelf implementations available on the internet, and if they’re not good enough, it’s not terribly difficult to implement K-Means on your own.
<br />
<strong>Weaknesses</strong>:The main weakness of K-Means is that it doesn’t work that well for non-spherical clusters. Also, as we discussed earlier, it’s also notorius for getting stuck in local minima, and requires the user to choose K.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-01-18T17:16:43-05:00" pubdate data-updated="true">Jan 18<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/01/18/latex-math-in-octopress/">LaTeX Math in Octopress</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I found this post helpful when trying to enable LaTeX style math formulas in Octopress:</p>

<p><a href="http://blog.zhengdong.me/2012/12/19/latex-math-in-octopress">http://blog.zhengdong.me/2012/12/19/latex-math-in-octopress</a></p>

<p>It’s also worth noting that when you change Octopress themes <code>source/_includes/custom/head.html</code> seems to get overwritten, so you have to re-add the provided snippet.</p>
</div>
  
  


        </article>
      
      
        <article class="post">
          
  <header class="page-header">
    
      <p class="meta text-muted text-uppercase">
        












<span class="glyphicon glyphicon-calendar"></span> <time datetime="2014-01-18T16:53:50-05:00" pubdate data-updated="true">Jan 18<span>th</span>, 2014</time>
        
      </p>
    
    
      <h1 class="entry-title"><a href="/blog/2014/01/18/finding-files-on-windows/">Finding Files on Windows</a></h1>
    
  </header>


  <div class="entry-content clearfix"><p>I often find myself in situations where I know a file exists but can’t find it.</p>

<p>On Windows, the following can be used to search for a file from the current working directory</p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
dir /s /b | findstr [search string]
</pre></div>
</div>
 </figure></notextile></div>

<p>Here <code>/s</code> denotes a recursive search, and <code>/b</code> allows the full paths of the files to be printed (omit that if the full paths are not desired). The results from the <code>dir</code> are piped to a <code>findstr</code> command where a filter can be applied to find the desired file(s).</p>

<p>If you have <code>grep</code> installed (e.g., via the <a href="http://sourceforge.net/projects/unxutils/">unix utilities</a>) you can replace <code>findstr</code> with <code>grep</code></p>

<div class="bogus-wrapper"><notextile><figure class="code"> <div class="CodeRay">
  <div class="code"><pre>
dir /s /b | grep [search string]
</pre></div>
</div>
 </figure></notextile></div>

</div>
  
  


        </article>
      
    </div>

    <ul class="pager">
      
        <li class="previous disabled"><a href="#">&larr;&nbsp;Older</a></li>
      
      <li><a href="/blog/archives">Blog Archives</a></li>
      
        <li class="next disabled"><a href="#">Newer&nbsp;&rarr;</a></li>
      
    </ul>
  </div>

  
    <aside class="sidebar col-md-3">
      
        <section class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">Recent Posts</h3>
  </div>
  
  <div id="recent_posts" class="list-group">
    
    <a class="list-group-item " href="/blog/2014/02/17/quicksort-in-c-number/">Quicksort in C#</a>
    
    <a class="list-group-item " href="/blog/2014/02/16/c-sharp-sorting-woes/">C# Sorting Woes</a>
    
    <a class="list-group-item " href="/blog/2014/02/14/fun-onenote-problem/">Hide and Seek With OneNote</a>
    
    <a class="list-group-item " href="/blog/2014/02/09/k-means-implementation-in-python/">K-Means in Python</a>
    
    <a class="list-group-item " href="/blog/2014/02/07/benchmarking-c-number/">Benchmarking C# Code</a>
    
  </div>
</section>






      
    </aside>
  
</div>

        </div>
      </div>
    </div>
    <footer role="contentinfo"><div class="container">
    <p class="text-muted credits">
  Copyright &copy; 2014 - Matt Nedrich<br>
  <small>
      <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>,
      <span class="credit">customized with <a href="https://github.com/kAworu/octostrap3">octostrap3</a></span>.
  </small>
</p>

</div>
</footer>
    <script src="/assets/bootstrap/dist/js/bootstrap.min.js"></script>
<script src="/javascripts/modernizr-2.0.js"></script>








  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





  </body>
</html>
